<div class="edit-commande">
  <div class="page-header">
    <h1>Modifier la commande #<%= @commande.id %></h1>
    <div class="status-info">
      <span class="status-badge status-<%= @commande.statut %>">
        <%= @commande.statut.humanize %>
      </span>
    </div>
  </div>

  <div class="edit-form-container">
    <%= form_with model: @commande, local: true, class: "edit-form" do |f| %>
      <% if @commande.errors.any? %>
        <div class="alert alert-danger">
          <h4><%= pluralize(@commande.errors.count, "erreur") %> empêche(nt) la modification :</h4>
          <ul>
            <% @commande.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="form-section">
        <h3>Informations modifiables</h3>
        <p class="form-info">
          Seules l'heure de retrait et les notes peuvent être modifiées.
        </p>

        <div class="form-group">
          <%= f.label :heure_retrait, "Heure de retrait souhaitée *" %>
          <%= f.time_field :heure_retrait, required: true, class: "form-control" %>
          <small class="form-text">Heure actuelle : <%= @commande.heure_retrait.strftime('%H:%M') %></small>
        </div>

        <div class="form-group">
          <%= f.label :notes, "Notes particulières" %>
          <%= f.text_area :notes, rows: 4, class: "form-control", 
                          placeholder: "Allergies, préférences, instructions spéciales..." %>
        </div>
      </div>

      <div class="readonly-section">
        <h3>Informations non modifiables</h3>
        <div class="readonly-grid">
          <div class="readonly-item">
            <strong>Client :</strong>
            <%= @commande.client_nom %>
          </div>
          <div class="readonly-item">
            <strong>Téléphone :</strong>
            <%= @commande.client_telephone %>
          </div>
          <div class="readonly-item">
            <strong>Email :</strong>
            <%= @commande.client_email %>
          </div>
          <div class="readonly-item">
            <strong>Date de retrait :</strong>
            <%= @commande.jour_commande.strftime('%d/%m/%Y') %>
          </div>
          <div class="readonly-item">
            <strong>Montant total :</strong>
            <%= @commande.montant_total.to_f %>€
          </div>
        </div>
      </div>

      <div class="form-actions">
        <%= f.submit "Mettre à jour la commande", class: "btn btn-primary" %>
        <%= link_to "Annuler", @commande, class: "btn btn-secondary" %>
      </div>
    <% end %>
  </div>

  <div class="warning-notice">
    <div class="warning-content">
      <i class="fas fa-exclamation-triangle"></i>
      <div>
        <strong>Important :</strong>
        Les plats commandés et les informations client ne peuvent pas être modifiés pour des raisons de sécurité et d'intégrité. 
        Si vous devez changer votre commande, veuillez nous contacter au 06 95 72 86 39.
      </div>
    </div>
  </div>
</div>

<style>
.edit-commande {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 2px solid #d4572a;
}

.page-header h1 {
  margin: 0;
  color: #333;
}

.status-badge {
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: bold;
  text-transform: uppercase;
}

.status-en_attente {
  background-color: #fff3cd;
  color: #856404;
  border: 1px solid #ffeaa7;
}

.status-confirmee {
  background-color: #d4edda;
  color: #155724;
  border: 1px solid #a3d9a4;
}

.edit-form-container {
  background: white;
  border-radius: 12px;
  padding: 30px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  margin-bottom: 30px;
}

.form-section {
  margin-bottom: 40px;
}

.form-section h3 {
  color: #d4572a;
  margin-bottom: 15px;
  font-size: 20px;
}

.form-info {
  color: #666;
  font-style: italic;
  margin-bottom: 25px;
  padding: 15px;
  background: #f8f9fa;
  border-radius: 8px;
  border-left: 4px solid #d4572a;
}

.form-group {
  margin-bottom: 25px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: #333;
}

.form-control {
  width: 100%;
  padding: 12px;
  border: 2px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
  transition: border-color 0.3s;
}

.form-control:focus {
  outline: none;
  border-color: #d4572a;
  box-shadow: 0 0 0 3px rgba(212, 87, 42, 0.1);
}

.form-text {
  display: block;
  margin-top: 5px;
  font-size: 12px;
  color: #666;
}

.readonly-section {
  margin-bottom: 30px;
  padding-top: 30px;
  border-top: 1px solid #eee;
}

.readonly-section h3 {
  color: #666;
  margin-bottom: 20px;
  font-size: 18px;
}

.readonly-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
}

.readonly-item {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 8px;
  border: 1px solid #e9ecef;
}

.readonly-item strong {
  display: block;
  margin-bottom: 5px;
  color: #495057;
  font-size: 13px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.form-actions {
  display: flex;
  gap: 15px;
  justify-content: center;
  padding-top: 20px;
  border-top: 1px solid #eee;
}

.btn {
  padding: 12px 30px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  text-decoration: none;
  display: inline-block;
  text-align: center;
  transition: all 0.3s;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.btn-primary {
  background: linear-gradient(135deg, #d4572a, #e67e22);
  color: white;
  box-shadow: 0 4px 15px rgba(212, 87, 42, 0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(212, 87, 42, 0.4);
}

.btn-secondary {
  background-color: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background-color: #5a6268;
  transform: translateY(-2px);
}

.warning-notice {
  background: linear-gradient(135deg, #fff3cd, #ffeaa7);
  border: 1px solid #ffc107;
  border-radius: 12px;
  padding: 20px;
  margin-top: 30px;
}

.warning-content {
  display: flex;
  align-items: flex-start;
  gap: 15px;
}

.warning-content i {
  color: #856404;
  font-size: 20px;
  margin-top: 2px;
}

.warning-content strong {
  color: #856404;
}

.alert {
  padding: 15px 20px;
  margin-bottom: 25px;
  border-radius: 8px;
}

.alert-danger {
  background-color: #f8d7da;
  color: #721c24;
  border: 1px solid #f5c6cb;
}

.alert h4 {
  margin: 0 0 10px 0;
  font-size: 16px;
}

.alert ul {
  margin: 0;
  padding-left: 20px;
}

@media (max-width: 768px) {
  .page-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 15px;
  }
  
  .readonly-grid {
    grid-template-columns: 1fr;
  }
  
  .form-actions {
    flex-direction: column;
  }
  
  .warning-content {
    flex-direction: column;
    text-align: center;
  }
}
</style> 